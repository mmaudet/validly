---
phase: 09-workflow-creation-ui
plan: 03
type: execute
wave: 3
depends_on: ["09-02"]
files_modified:
  - frontend/src/components/workflow/TemplatePicker.tsx
  - frontend/src/components/workflow/ReviewStep.tsx
  - frontend/src/pages/WorkflowCreatePage.tsx
autonomous: true
requirements: []
must_haves:
  truths:
    - "User can optionally load a saved template to pre-fill the circuit builder"
    - "Review step shows the full configuration before launch"
    - "Clicking 'Launch' creates the workflow and redirects to the detail page"
  artifacts:
    - path: "frontend/src/components/workflow/TemplatePicker.tsx"
      provides: "Template list with load action"
      min_lines: 40
    - path: "frontend/src/components/workflow/ReviewStep.tsx"
      provides: "Read-only summary of full workflow configuration"
      min_lines: 50
  key_links:
    - from: "frontend/src/components/workflow/TemplatePicker.tsx"
      to: "/api/templates"
      via: "useQuery fetching templates"
      pattern: "apiFetch.*templates"
    - from: "frontend/src/pages/WorkflowCreatePage.tsx"
      to: "/api/documents"
      via: "useMutation uploading files in parallel"
      pattern: "apiFetch.*documents.*FormData"
    - from: "frontend/src/pages/WorkflowCreatePage.tsx"
      to: "/api/workflows"
      via: "POST workflow with documentIds"
      pattern: "apiFetch.*workflows.*POST"
---

## Objective

Complete the wizard with template loading, read-only review step, and launch mutation that uploads documents and creates the workflow.

Purpose: Final piece — connecting the wizard to backend APIs for end-to-end workflow creation.
Output: Working end-to-end creation flow from dashboard to launched workflow.

## Context

```
@frontend/src/pages/WorkflowCreatePage.tsx
@frontend/src/components/workflow/CircuitBuilderStep.tsx
@frontend/src/lib/api.ts
```

## Task 1: TemplatePicker and ReviewStep Components

**Type:** auto
**Files:**
- `frontend/src/components/workflow/TemplatePicker.tsx` (create)
- `frontend/src/components/workflow/ReviewStep.tsx` (create)

**Action:**

1. **TemplatePicker.tsx** — Fetches templates via `useQuery` + `apiFetch('/templates?limit=50')`. Renders as a dropdown toggled by a button. Each template shows name/description. On click: calls `onSelect(template)` callback. Uses `isPending` (TQ v5).

2. **ReviewStep.tsx** — Uses `useFormContext` + `watch()` to read all form values. Receives `files: File[]` as prop. Displays read-only summary: title, document list, and full circuit (phases → steps with quorum rules, validators, deadlines).

## Task 2: Template Loading Integration and Launch Mutation

**Type:** auto
**Files:**
- `frontend/src/pages/WorkflowCreatePage.tsx` (modify)

**Action:**

1. Import TemplatePicker and ReviewStep
2. Template loading: `reset({ ...getValues(), structure: template.structure })` preserves title
3. Replace review placeholder with `<ReviewStep files={files} />`
4. Launch mutation using `useMutation`:
   - Upload all staged files in parallel via `Promise.all` + `POST /documents` (FormData)
   - Collect returned document IDs
   - `POST /workflows` with title + documentIds + structure
   - On success: `invalidateQueries(['workflows'])` + `navigate(\`/workflows/${id}\`)`
5. Wire Launch button: `handleSubmit()` → `launchMutation.mutate()`, show `isPending` state, display errors

## Verification

- `cd frontend && npx tsc --noEmit` passes
- Full flow: Dashboard → New Workflow → upload files → build circuit (or load template) → review → Launch → redirect to workflow detail
- Switch to FR locale → all labels translated
- Load a template → circuit pre-fills while title preserved
- Launch with real files → workflow created, appears on dashboard
